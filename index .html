<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>水泵系统能源诊断规则完整版</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4efe9 100%);
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        header {
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        h1 {
            font-size: 2.2rem;
            margin-bottom: 15px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }
        .header-info {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        .header-info p {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        .content {
            padding: 30px;
        }
        h2 {
            color: #2980b9;
            border-left: 5px solid #3498db;
            padding-left: 15px;
            margin: 30px 0 20px;
            font-size: 1.8rem;
        }
        h3 {
            color: #34495e;
            margin: 25px 0 15px;
            font-size: 1.4rem;
        }
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        ul, ol {
            margin-bottom: 20px;
            padding-left: 30px;
        }
        li {
            margin-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
            font-size: 14px;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border: 1px solid #ddd;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background-color: #e9f7fe;
        }
        .formula {
            font-family: 'Courier New', monospace;
            background-color: #f8f9fa;
            padding: 5px 10px;
            border-radius: 4px;
            border: 1px solid #e9ecef;
            display: inline-block;
            margin: 5px 0;
        }
        .note {
            background-color: #fffde7;
            padding: 20px;
            border-left: 4px solid #ffeb3b;
            margin: 25px 0;
            border-radius: 0 8px 8px 0;
        }
        .download-section {
            text-align: center;
            padding: 30px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
        }
        .download-btn {
            display: inline-block;
            padding: 15px 40px;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(46, 204, 113, 0.6);
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            color: #7f8c8d;
            font-size: 0.9rem;
            padding: 20px;
            border-top: 1px solid #e9ecef;
        }
        @media (max-width: 768px) {
            .container {
                border-radius: 10px;
            }
            header {
                padding: 20px;
            }
            h1 {
                font-size: 1.8rem;
            }
            .content {
                padding: 20px;
            }
            table {
                font-size: 12px;
            }
            th, td {
                padding: 8px 10px;
            }
        }
        .section-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
            justify-content: center;
        }
        .section-nav a {
            padding: 8px 15px;
            background: #e9f7fe;
            border-radius: 20px;
            text-decoration: none;
            color: #2980b9;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        .section-nav a:hover {
            background: #3498db;
            color: white;
        }
        .rule-table {
            font-size: 13px;
        }
        .rule-table th, .rule-table td {
            padding: 10px 12px;
        }
        .risk-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #3498db;
            color: white;
            text-align: center;
            line-height: 30px;
            border-radius: 50%;
            margin-right: 10px;
            font-weight: bold;
        }
        .tab-container {
            margin: 20px 0;
        }
        .tab-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 15px;
        }
        .tab-btn {
            padding: 10px 20px;
            background: #e9f7fe;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        .tab-btn.active {
            background: #3498db;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>水泵系统能源诊断规则完整版</h1>
            <div class="header-info">
                <p><strong>文档版本：</strong> V3.0</p>
                <p><strong>生成日期：</strong> 2025-09-04</p>
                <p><strong>编制：</strong> 水泵节能诊断专家系统</p>
                <p><strong>适用范围：</strong> 单台、并联、串联离心泵系统</p>
            </div>
        </header>

        <div class="content">
            <div class="section-nav">
                <a href="#section1">1. 总则</a>
                <a href="#section2">2. 诊断规则表</a>
                <a href="#section3">3. 诊断流程</a>
                <a href="#section4">4. 节能模型</a>
                <a href="#download">下载文档</a>
            </div>

            <h2 id="section1">1. 总则</h2>
            
            <h3>1.1 目标</h3>
            <p>在满足工艺约束前提下，通过IoT数据与资产台账，自动诊断泵系统运行状态，识别低效与风险点，提供可执行对策并量化节能潜力，最终使运行点长期接近BEP（最佳效率点，<span class="formula">r_Q ∈ [0.90,1.10]</span>），实现安全、高效、可靠运行。</p>
            
            <h3>1.2 数据基础</h3>
            <ul>
                <li><strong>IoT数据（1分钟采样，5-15分钟稳态窗口聚合）：</strong> 流量(Q)、进出口压力(P_suc, P_dis)、频率(n/f)、电机输入功率(Pe/WT)、电流(I)、阀位、过滤器压差(DP_STR)、旁通/最小回流流量(Q_bp/Q_min)、温度（绕组T_winding、机壳T_frame、环境T_amb）等。</li>
                <li><strong>资产台账：</strong> 泵H-Q、η-Q曲线、Q_BEP、η_BEP、NPSHr(Q)曲线；电机IE等级、额定功率、绝缘等级；VFD与联轴器类型及效率。</li>
            </ul>
            
            <h3>1.3 核心概念</h3>
            <ul>
                <li><strong>r_Q (相对流量比):</strong> <span class="formula">r_Q = Q_ref / Q_BEP</span>，其中<span class="formula">Q_ref</span>为经相似定律换算至50Hz的等效流量。</li>
                <li><strong>驱动链效率 (η_chain):</strong> <span class="formula">η_chain = η_vfd · η_motor_corr · η_coupling</span></li>
                <li><strong>水力功率 (P_hyd):</strong> <span class="formula">P_hyd = ρ · g · Q · H / 1000</span> (kW)</li>
                <li><strong>系统扬程 (H_sys):</strong> <span class="formula">H_sys(Q) = H0 + k·Q²</span>，通过稳态点回归拟合得到，用于计算节流损失扬程<span class="formula">H_valve = H - H_sys(Q)</span>。</li>
            </ul>

            <h2 id="section2">2. 统一诊断规则表</h2>
            
            <div class="tab-container">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="openTab('tab1')">R1-R12 基础规则</button>
                    <button class="tab-btn" onclick="openTab('tab2')">G1-G9 系统规则</button>
                    <button class="tab-btn" onclick="openTab('tab3')">E01-E15 场景矩阵</button>
                </div>
                
                <div id="tab1" class="tab-content active">
                    <p>以下规则按优先级排列，综合了安全守护、能效优化与设备健康因素。</p>
                    
                    <table class="rule-table">
                        <thead>
                            <tr>
                                <th width="70">规则编号</th>
                                <th width="120">问题描述</th>
                                <th width="150">触发条件与阈值</th>
                                <th width="150">主要原因</th>
                                <th width="180">诊断与验证方法</th>
                                <th width="150">优先对策</th>
                                <th width="180">可量化节能公式（示例）</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>R1</strong></td>
                                <td><strong>节流（阀损过高）</strong></td>
                                <td>F_valve≥0.10 或 valve_open_pct≤30%（稳态10min均值）</td>
                                <td>设定过高；控制参数不当；并泵切换滞后</td>
                                <td>计算 H_ref 与 H_sys(Q_ref)→H_valve=max(H_ref−H_sys,0)，F_valve=H_valve/H_ref；核对阀位趋势/流程状态</td>
                                <td>有VFD优先降速/降设定（目标 F_valve≤5%）；增大死区/滞回；中长期缩泵/改阻力</td>
                                <td><span class="formula">ΔP_thrtl(kW)=ρg·Q_m3s·max(H_valve−0.05·H_ref,0)/1000</span></td>
                            </tr>
                            <tr>
                                <td><strong>R2</strong></td>
                                <td><strong>过滤器阻塞</strong></td>
                                <td>ΔP_str≥0.20 bar 或 H_str/H_ref≥0.05</td>
                                <td>滤网堵塞；滤材寿命；固体携带</td>
                                <td>用差压变送器求 H_str=10.197·ΔP_str(bar)；与维护记录/流量变化交叉验证</td>
                                <td>清洗/更换过滤器；前端预处理；设置差压报警/联锁</td>
                                <td><span class="formula">ΔP_str(kW)=ρg·Q_m3s·(10.197·(ΔP_str−0.10))/1000（当ΔP_str>0.10）</span></td>
                            </tr>
                            <tr>
                                <td><strong>R3</strong></td>
                                <td><strong>旁通/最小回流偏大</strong></td>
                                <td>recirc_share≥3% 或 物料守恒差≥3%</td>
                                <td>最小流设定过大；旁通阀泄漏；切泵逻辑不当</td>
                                <td>由出入口流量或箱位变化做物料平衡估算 recirc_share；检查阀门开度/温度差</td>
                                <td>校核最小流；优化切泵滞回；修阀座/更换阀</td>
                                <td><span class="formula">ΔP_bp(kW)=(recirc_before−recirc_after)·P_e</span></td>
                            </tr>
                            <tr>
                                <td><strong>R4</strong></td>
                                <td><strong>机械效率异常（轴承/密封/摩擦）</strong></td>
                                <td>(η_chain·P_e − P_hyd) ≥ 5%·(η_chain·P_e)</td>
                                <td>轴承/密封磨损；转子偏心；壳体摩擦</td>
                                <td>分解功率：P_hyd、P_thrtl、P_str、P_bp；残差定位；结合振动/温升谱</td>
                                <td>检修轴承/密封；校正/润滑；动平衡</td>
                                <td><span class="formula">ΔP≈[(η_chain·P_e−P_hyd)_before − (η_chain·P_e−P_hyd)_after]</span></td>
                            </tr>
                            <tr>
                                <td><strong>R5</strong></td>
                                <td><strong>传动链残差偏高（VFD/联轴器/皮带）</strong></td>
                                <td>(P_e − η_chain·P_e) ≥ 5%·P_e</td>
                                <td>VFD效率低/谐波；联轴器/皮带损失</td>
                                <td>计算链损 P_chain_loss=P_e−P_shaft；对比载荷依赖性与谐波指标</td>
                                <td>谐波治理/优化VFD参数；联轴器/皮带维护或更换</td>
                                <td><span class="formula">ΔP≈(P_chain_loss_before − P_chain_loss_after)</span></td>
                            </tr>
                            <tr>
                                <td><strong>R6</strong></td>
                                <td><strong>电机热效率劣化</strong></td>
                                <td>η_motor 下降≥2–3个百分点 或 绕组温升逼近限值</td>
                                <td>自冷不足；环境温度高；积灰</td>
                                <td>用绕组/机壳温度与效率曲线估算 η_motor；对比同负荷 SE</td>
                                <td>加装外置风机/清灰；使工况靠近 BEP</td>
                                <td><span class="formula">ΔP≈P_e_before − P_e_after（同Q/H）</span></td>
                            </tr>
                            <tr>
                                <td><strong>R7</strong></td>
                                <td><strong>联轴器/对中异常</strong></td>
                                <td>振动RMS>现场阈值 或 链损高且与负荷弱相关</td>
                                <td>对中偏差；弹性体老化；张力异常</td>
                                <td>振动谱+相位；红外对中；功率残差随负荷不变的证据</td>
                                <td>激光对中/动平衡；更换弹性体/调张力</td>
                                <td><span class="formula">ΔP≈P_res_before − P_res_after</span></td>
                            </tr>
                            <tr>
                                <td><strong>R8</strong></td>
                                <td><strong>汽蚀风险</strong></td>
                                <td>ΔNPSH=NPSHa−NPSHr ≤0.5 m（报警）/≤0（保护）</td>
                                <td>液位低；吸入损失大；温度高；运行点偏右</td>
                                <td>用 PT_suc、液位、温度估算 NPSHa；厂家曲线得 NPSHr(Q_ref)</td>
                                <td>升液位/降温；加大吸入管/减少局部阻力；限速回BEP</td>
                                <td>节能以 SE 改善+故障率下降评估</td>
                            </tr>
                            <tr>
                                <td><strong>R9</strong></td>
                                <td><strong>计量闭合异常</strong></td>
                                <td>d_curve>0.05 或 |P_res|/P_e>0.08 或 质量差>5%</td>
                                <td>单位/标高/密度口径不一致；零漂；错误曲线</td>
                                <td>统一口径/温度密度；用跨泵DPT替代；重新标定</td>
                                <td>先完成计量闭合再执行其它优化</td>
                                <td>（前置条件，无直接节能）</td>
                            </tr>
                            <tr>
                                <td><strong>R10</strong></td>
                                <td><strong>VFD打摆（振荡）</strong></td>
                                <td>Q/f 1–5min 周期振荡且 cv(Q)>3%、cv(f)>1% 或 r_Q 往返穿越 BEP</td>
                                <td>PI 过激；回路耦合；死区过小；切泵抖动</td>
                                <td>时域/频域评估；窗口 CV；BEP 穿越计数</td>
                                <td>设置死区±2%Q/±0.5mH；P/I各降20–40%；df/dt≤0.2Hz/s；切泵保持20–30min</td>
                                <td><span class="formula">ΔP≈avg(P_e)_before − avg(P_e)_after（同负荷带）</span></td>
                            </tr>
                            <tr>
                                <td><strong>R11</strong></td>
                                <td><strong>低频效率/冷却约束</strong></td>
                                <td>f<f_min（无外风机默认28Hz；外风机22Hz）或 CoolingMargin≤0</td>
                                <td>自冷不足；谐波/铁耗上升</td>
                                <td>用 η_motor(f,T) 与温升模型评估效率与冷却裕度</td>
                                <td>提高 f_min 或加外风机；低负荷合台运行</td>
                                <td><span class="formula">ΔP≈η_motor 修正后的 P_e 差额</span></td>
                            </tr>
                            <tr>
                                <td><strong>R12</strong></td>
                                <td><strong>过载</strong></td>
                                <td>I/Irated≥1 或 P_e>P_rated</td>
                                <td>目标扬程过高；阻力异常；选型偏小；偏右运行</td>
                                <td>电气侧电流/功率；曲线位置 r_Q；与系统阻力核对</td>
                                <td>限速/降设定；并泵分担；降阻/除垢；复核选型</td>
                                <td><span class="formula">ΔP = P_e_before − P_e_after（解除过载后）</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div id="tab2" class="tab-content">
                    <p>系统级规则适用于并联和串联泵系统。</p>
                    
                    <table class="rule-table">
                        <thead>
                            <tr>
                                <th width="70">规则编号</th>
                                <th width="120">问题描述</th>
                                <th width="150">触发条件与阈值</th>
                                <th width="150">主要原因</th>
                                <th width="180">诊断与验证方法</th>
                                <th width="150">优先对策</th>
                                <th width="180">可量化节能公式（示例）</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>G1</strong></td>
                                <td><strong>并联调度：以 SE 最小化 + r_Q 滞回切泵</strong></td>
                                <td>SE_est(n+1)+δ < SE_now 且 r_Q_any≥1.10 持续≥3min → 投泵；SE_est(n−1)−δ < SE_now 且 r_Q_all≤0.90 持续≥3min → 减泵；保持20min滞回</td>
                                <td>固定台数或整定不当导致偏离最佳能耗；负荷波动大</td>
                                <td>构建 SE(Q_out,n) 模型或近7日地图；在线比较 SE_now 与 SE_est(n±1)；监视 r_Q 滞回阈值</td>
                                <td>按 SE 最小化策略启停泵；near 区域优先降速代替节流；均衡各机组负荷</td>
                                <td><span class="formula">ΔSE = SE_before − SE_after；年节电≈ΔSE×ΣQ</span></td>
                            </tr>
                            <tr>
                                <td><strong>G2</strong></td>
                                <td><strong>并联系统失衡/跑偏</strong></td>
                                <td>std(r_Q_i)≥0.10 或 任一阀位≤20%</td>
                                <td>水力不对称；控制分配不均</td>
                                <td>对比各泵 r_Q、阀位、功率；检查并联管路阻力差</td>
                                <td>调平频率/阀位；排查水力不对称</td>
                                <td><span class="formula">ΔP = P_e_before − P_e_after（同 Q_out）</span></td>
                            </tr>
                            <tr>
                                <td><strong>G3</strong></td>
                                <td><strong>串联系统阶段扬程匹配</strong></td>
                                <td>任一段 H_stage_i/ΣH 偏离目标≥10%</td>
                                <td>频率配比不当；段曲线偏差</td>
                                <td>按设计占比计算目标比；用段压差或DPT估算各段 H</td>
                                <td>按设计占比调整各段频率比；必要时重标定段曲线</td>
                                <td><span class="formula">ΔP = ρg·Q·(ΣH_before − ΣH_after)/1000</span></td>
                            </tr>
                            <tr>
                                <td><strong>G4</strong></td>
                                <td><strong>串联首段 NPSH 守护</strong></td>
                                <td>首段 ΔNPSH≤0.5 m</td>
                                <td>首段吸入条件差；温度高；阻力大</td>
                                <td>计算首段 NPSHa 与 NPSHr；监视液位/温度/吸入压损</td>
                                <td>降低首段频率；升液位/降温；优化吸入侧管路</td>
                                <td>以可靠性为主；能效来自回归 BEP 的 SE 下降</td>
                            </tr>
                            <tr>
                                <td><strong>G5</strong></td>
                                <td><strong>串联系统中间阀损</strong></td>
                                <td>ΔH_interstage_valve/H_total≥5%</td>
                                <td>中间节流过大；分段目标不当</td>
                                <td>用中间阀前后压差估算 ΔH_interstage_valve</td>
                                <td>开大中间阀；重设分段目标</td>
                                <td><span class="formula">ΔP = ρg·Q·ΔH_interstage_valve/1000</span></td>
                            </tr>
                            <tr>
                                <td><strong>G6</strong></td>
                                <td><strong>变频：节流优先降速</strong></td>
                                <td>F_valve≥5% 或 阀位≤60%</td>
                                <td>维持设定导致多余扬程在阀上消耗</td>
                                <td>计算 H_valve、F_valve；验证降速对工艺的影响</td>
                                <td>先降速使 F_valve→≤5%，再细调阀位</td>
                                <td><span class="formula">ΔP≈ρg·Q·ΔH_valve/1000 + η_motor 回升收益</span></td>
                            </tr>
                            <tr>
                                <td><strong>G7</strong></td>
                                <td><strong>变频：打摆抑制</strong></td>
                                <td>cv(Q,1–5min)>3% 且 cv(f)>1% 或 r_Q 反复穿越 BEP</td>
                                <td>PI 过激；回路耦合；死区设置不当</td>
                                <td>时域/频域识别；窗口 CV；BEP 穿越计数</td>
                                <td>设死区±2%Q/±0.5mH；P/I 降20–40%；df/dt≤0.2Hz/s；切泵后保持20–30min</td>
                                <td><span class="formula">ΔVar(P_e) 与 ΔSE 前后对比</span></td>
                            </tr>
                            <tr>
                                <td><strong>G8</strong></td>
                                <td><strong>变频：低频效率/冷却约束</strong></td>
                                <td>f<f_min 或 CoolingMargin≤0（默认 f_min=28Hz，无外风机）</td>
                                <td>自冷不足；铁耗/谐波增加</td>
                                <td>结合 η_motor(f,T) 与温升模型评估；检查电机风扇/外风机</td>
                                <td>提高 f_min 或加外风机；低负荷合台运行</td>
                                <td><span class="formula">ΔP≈按 η_motor(f,T) 修正后的 P_e 差额</span></td>
                            </tr>
                            <tr>
                                <td><strong>G9</strong></td>
                                <td><strong>变频：过载约束</strong></td>
                                <td>I/Irated≥1 或 P_e>P_rated</td>
                                <td>目标扬程过高；阻力异常；选型偏小</td>
                                <td>电流/功率/温升监测；曲线位置 r_Q 与系统阻力核对</td>
                                <td>限频、降设定、并泵分担</td>
                                <td><span class="formula">ΔP = 过载解除前后 P_e 差额</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div id="tab3" class="tab-content">
                    <p>场景矩阵规则根据运行点位置(r_Q)和曲线距离(d_curve)提供更细化的诊断。</p>
                    
                    <table class="rule-table">
                        <thead>
                            <tr>
                                <th width="80">规则编号</th>
                                <th width="150">场景描述</th>
                                <th width="120">r_Q范围</th>
                                <th width="120">d_curve范围</th>
                                <th width="150">主要问题</th>
                                <th width="150">优先对策</th>
                                <th width="150">可量化节能公式</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>E01</strong></td>
                                <td>左端：低流高扬程/泵偏大或设定偏高；曲线一致</td>
                                <td>r_Q<0.70</td>
                                <td>d_curve≤0.05</td>
                                <td>节流损失高；泵选型偏大/目标扬程偏高</td>
                                <td>有VFD优先降速/降设定；清洗/更换过滤器；长期缩泵/优化系统阻力</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E02</strong></td>
                                <td>左端：低流高扬程/泵偏大或设定偏高；轻度不闭合</td>
                                <td>r_Q<0.70</td>
                                <td>0.05–0.10</td>
                                <td>节流损失高；泵选型偏大/目标扬程偏高</td>
                                <td>先做R9计量闭合；有VFD优先降速/降设定；清洗/更换过滤器</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E03</strong></td>
                                <td>左端：低流高扬程/泵偏大或设定偏高；明显不闭合</td>
                                <td>r_Q<0.70</td>
                                <td>>0.10</td>
                                <td>节流损失高；泵选型偏大/目标扬程偏高</td>
                                <td>先做R9计量闭合；有VFD优先降速/降设定；清洗/更换过滤器</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E04</strong></td>
                                <td>偏左：轻度节流/系统阻力偏大；曲线一致</td>
                                <td>0.70–0.90</td>
                                <td>d_curve≤0.05</td>
                                <td>轻度节流与阻力叠加；效率偏离BEP</td>
                                <td>适度开阀/降速，使r_Q→0.95~1.05；清滤/减阻；校正系统曲线</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E05</strong></td>
                                <td>偏左：轻度节流/系统阻力偏大；轻度不闭合</td>
                                <td>0.70–0.90</td>
                                <td>0.05–0.10</td>
                                <td>轻度节流与阻力叠加；效率偏离BEP</td>
                                <td>先做R9计量闭合；适度开阀/降速，使r_Q→0.95~1.05；清滤/减阻</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E06</strong></td>
                                <td>偏左：轻度节流/系统阻力偏大；明显不闭合</td>
                                <td>0.70–0.90</td>
                                <td>>0.10</td>
                                <td>轻度节流与阻力叠加；效率偏离BEP</td>
                                <td>先做R9计量闭合；适度开阀/降速，使r_Q→0.95~1.05；清滤/减阻</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E07</strong></td>
                                <td>BEP附近：应在高效率区；曲线一致</td>
                                <td>0.90–1.10</td>
                                <td>d_curve≤0.05</td>
                                <td>整体有效率高但仍可优化能流</td>
                                <td>精细化调参，F_valve≤5%；清滤到ΔP_str≤0.10bar；复核旁通联锁，recirc≤1%</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E08</strong></td>
                                <td>BEP附近：应在高效率区；轻度不闭合</td>
                                <td>0.90–1.10</td>
                                <td>0.05–0.10</td>
                                <td>曲线不闭合/口径不一致；效率评估可信度低</td>
                                <td>执行计量闭合整改（统一口径、DPT跨泵、温度密度修正）；闭合后再应用R1–R3微优化</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E09</strong></td>
                                <td>BEP附近：应在高效率区；明显不闭合</td>
                                <td>0.90–1.10</td>
                                <td>>0.10</td>
                                <td>曲线不闭合/口径不一致；效率评估可信度低</td>
                                <td>执行计量闭合整改（统一口径、DPT跨泵、温度密度修正）；闭合后再应用R1–R3微优化</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E10</strong></td>
                                <td>偏右：高流低扬程/过载风险上升；曲线一致</td>
                                <td>1.10–1.20</td>
                                <td>d_curve≤0.05</td>
                                <td>过载/NPSH裕度下降风险；效率下降</td>
                                <td>限速/降设定，使r_Q回到≤1.1；减阻/升液位/中间级保护；校核选型与切泵策略</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E11</strong></td>
                                <td>偏右：高流低扬程/过载风险上升；轻度不闭合</td>
                                <td>1.10–1.20</td>
                                <td>0.05–0.10</td>
                                <td>过载/NPSH裕度下降风险；效率下降</td>
                                <td>先做R9计量闭合；限速/降设定，使r_Q回到≤1.1；减阻/升液位/中间级保护</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E12</strong></td>
                                <td>偏右：高流低扬程/过载风险上升；明显不闭合</td>
                                <td>1.10–1.20</td>
                                <td>>0.10</td>
                                <td>过载/NPSH裕度下降风险；效率下降</td>
                                <td>先做R9计量闭合；限速/降设定，使r_Q回到≤1.1；减阻/升液位/中间级保护</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E13</strong></td>
                                <td>极右：汽蚀/过载高风险；曲线一致</td>
                                <td>≥1.20</td>
                                <td>d_curve≤0.05</td>
                                <td>汽蚀/电机过载高风险；振动与能耗显著异常</td>
                                <td>立即限速并回避右侧区，保障ΔNPSH>0.5m；升液位/降温/加大吸入管/减少构件；分段供压/并泵分担/复核选型</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E14</strong></td>
                                <td>极右：汽蚀/过载高风险；轻度不闭合</td>
                                <td>≥1.20</td>
                                <td>0.05–0.10</td>
                                <td>汽蚀/电机过载高风险；振动与能耗显著异常</td>
                                <td>先做R9计量闭合；立即限速并回避右侧区，保障ΔNPSH>0.5m；升液位/降温/加大吸入管/减少构件</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                            <tr>
                                <td><strong>E15</strong></td>
                                <td>极右：汽蚀/过载高风险；明显不闭合</td>
                                <td>≥1.20</td>
                                <td>>0.10</td>
                                <td>汽蚀/电机过载高风险；振动与能耗显著异常</td>
                                <td>先做R9计量闭合；立即限速并回避右侧区，保障ΔNPSH>0.5m；升液位/降温/加大吸入管/减少构件</td>
                                <td><span class="formula">ΔP_total ≈ ΔP_thrtl + ΔP_str + ΔP_bp</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="note">
                <strong>说明：</strong>
                <ul>
                    <li><strong>绝缘等级温度限值：</strong> A(105℃)/E(120℃)/B(130℃)/F(155℃)/H(180℃)。越上限10℃预警，越限强告警。</li>
                    <li><strong>联轴器效率典型值：</strong> 直联≈1.00，弹性爪形≈0.99，齿式≈0.98，同步带≈0.97，V带≈0.94。发现异常可降额0.01-0.03。</li>
                    <li><strong>NPSHa计算：</strong> <span class="formula">NPSHa = (P_suc_abs - P_vapor) / (ρ·g) + z - h_loss</span>。需注意表压换绝压（+当地大气压）。</li>
                </ul>
            </div>

            <h2 id="section3">3. 诊断流程与输出</h2>
            
            <h3>3.1 诊断决策流程</h3>
            <ol>
                <li><strong>安全优先：</strong> 优先检查R8（汽蚀，M<1.1）和R12（过载），若触发需立即整改。</li>
                <li><strong>区域化策略：</strong> 根据<span class="formula">r_Q</span>将运行点划分为<span class="formula">S0/R1/R2/R3/R4/R5</span>区域，执行相应动作，目标使<span class="formula">r_Q</span>进入[0.95,1.05]的BEP区。</li>
                <li><strong>控制优化：</strong> 对恒压差系统，建议每30-60分钟做±3%设定寻优，选择SE更低的设定，并设置滞回（±0.5-1Hz）与最小保持时间（15-30min）。</li>
                <li><strong>变频寻优：</strong> 在<span class="formula">n∈[20,50]Hz</span>网格搜索最小SE（或最大η），输出最优频率<span class="formula">n*</span>及对应的<span class="formula">Q*, H*, η*, SE*</span>。</li>
            </ol>
            
            <h3>3.2 系统级策略（并联/串联）</h3>
            <ul>
                <li><strong>并联：</strong> 计算每台泵的<span class="formula">SE_i = Pe_i / Q_i</span>，选择使总<span class="formula">ΣSE_i</span>最小的泵组合运行，结合<span class="formula">r_Q</span>滞回(±0.03)与保持时间避免频繁启停。</li>
                <li><strong>串联：</strong> 在相同流量Q下，优化各级泵转速<span class="formula">n_i</span>，使各级<span class="formula">r_Q</span>收敛至BEP区且总<span class="formula">ΣSE_i</span>最小，并守护中间级NPSH。</li>
            </ul>
            
            <h3>3.3 输出与验收</h3>
            <ul>
                <li><strong>输出字段：</strong> <span class="formula">region_code, r_Q, Δη_pp, SE, H_valve, η_chain, η_vfd, η_motor, η_cpl, P_shaft, η_pump_mech, n*_hz, savings_kW, savings_%, evidence</span>。</li>
                <li><strong>验收标准：</strong>
                    <ul>
                        <li>随机抽取10个15分钟稳态窗口，人工复核一致率≥90%。</li>
                        <li>实施前后1-2周对比，单位能耗（kWh或kWh/m³）下降≥10%（VFD改造项目通常可达10-25%）。</li>
                    </ul>
                </li>
            </ul>

            <h2 id="section4">4. 节能效益量化总模型</h2>
            <p>无论采取何种对策，其最终节能量均可纳入以下模型进行经济效益和环保效益评估：</p>
            
            <p><strong>节能量 (ΔE, kWh):</strong><br>
            <span class="formula">ΔE = (P_before - P_after) × T_annual_runtime</span></p>
            
            <p><strong>节电费 (Savings, 元):</strong><br>
            <span class="formula">Savings = ΔE × C_electricity_price</span></p>
            
            <p><strong>CO₂减排量 (ΔCO₂, 吨):</strong><br>
            <span class="formula">ΔCO₂ = ΔE × F_carbon_emission_factor</span></p>
            
            <p><strong>投资回收期 (PP, 年):</strong><br>
            <span class="formula">PP = Investment_Cost / Savings</span></p>

            <div class="footer">
                <p>**附录：核心符号与公式**</p>
                <p>- <span class="formula">ρ</span>: 介质密度 (kg/m³)</p>
                <p>- <span class="formula">g</span>: 重力加速度 (9.81 m/s²)</p>
                <p>- <span class="formula">Q</span>: 体积流量 (m³/h, 计算功率时需转换为 m³/s)</p>
                <p>- <span class="formula">H</span>: 扬程 (m)</p>
                <p>- <span class="formula">P_hyd</span>: 水力功率 (kW), <span class="formula">P_hyd = ρ · g · Q · H / 1000</span></p>
                <p>- <span class="formula">P_elec</span>: 电机输入电功率 (kW)</p>
                <p>- <span class="formula">η_chain</span>: 驱动链效率, <span class="formula">η_chain = η_vfd · η_motor · η_cpl</span></p>
                <p>- <span class="formula">P_shaft</span>: 泵轴功率 (kW), <span class="formula">P_shaft = P_elec · η_chain</span></p>
                <p>- <span class="formula">SE</span>: 单位能耗 (kWh/m³), <span class="formula">SE = P_shaft / Q</span></p>
            </div>
        </div>

        <div class="download-section" id="download">
            <button class="download-btn" onclick="downloadWord()">⬇ 下载Word文档</button>
        </div>

        <div class="footer">
            <p>© 2025 水泵节能诊断专家系统 | 本文档内容仅供参考，实际应用请结合具体设备参数</p>
        </div>
    </div>

    <script>
        function openTab(tabId) {
            // 隐藏所有标签内容
            var tabContents = document.getElementsByClassName("tab-content");
            for (var i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }
            
            // 移除所有按钮的活动状态
            var tabButtons = document.getElementsByClassName("tab-btn");
            for (var i = 0; i < tabButtons.length; i++) {
                tabButtons[i].classList.remove("active");
            }
            
            // 显示选中的标签内容
            document.getElementById(tabId).classList.add("active");
            
            // 设置按钮为活动状态
            event.currentTarget.classList.add("active");
        }
        
        function downloadWord() {
            // 创建一个简单的Word文档内容
            const content = `
                <html xmlns:o="urn:schemas-microsoft-com:office:office" 
                      xmlns:w="urn:schemas-microsoft-com:office:word" 
                      xmlns="http://www.w3.org/TR/REC-html40">
                <head>
                    <meta charset="utf-8">
                    <title>水泵系统能源诊断规则完整版</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 2cm; }
                        h1 { color: #2c3e50; text-align: center; }
                        h2 { color: #2980b9; border-bottom: 1px solid #3498db; padding-bottom: 0.5cm; }
                        table { width: 100%; border-collapse: collapse; margin: 1cm 0; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #3498db; color: white; }
                        .formula { font-family: "Courier New", monospace; background-color: #f8f9fa; padding: 2px 5px; }
                    </style>
                </head>
                <body>
                    <h1>水泵系统能源诊断规则完整版</h1>
                    <p><strong>文档版本：</strong> V3.0</p>
                    <p><strong>生成日期：</strong> 2025-09-04</p>
                    <p><strong>编制：</strong> 水泵节能诊断专家系统</p>
                    <p><strong>适用范围：</strong> 单台、并联、串联离心泵系统</p>
                    
                    <h2>1. 总则</h2>
                    <h3>1.1 目标</h3>
                    <p>在满足工艺约束前提下，通过IoT数据与资产台账，自动诊断泵系统运行状态，识别低效与风险点，提供可执行对策并量化节能潜力，最终使运行点长期接近BEP（最佳效率点，<span class="formula">r_Q ∈ [0.90,1.10]</span>），实现安全、高效、可靠运行。</p>
                    
                    <h2>2. 统一诊断规则表</h2>
                    ${document.querySelector('#tab1').innerHTML}
                    
                    <h2>3. 诊断流程与输出</h2>
                    <h3>3.1 诊断决策流程</h3>
                    ${document.querySelector('#section3 ol').outerHTML}
                    
                    <h2>4. 节能效益量化总模型</h2>
                    <p><strong>节能量 (ΔE, kWh):</strong><br>
                    <span class="formula">ΔE = (P_before - P_after) × T_annual_runtime</span></p>
                    
                    <p><strong>节电费 (Savings, 元):</strong><br>
                    <span class="formula">Savings = ΔE × C_electricity_price</span></p>
                </body>
                </html>
            `;
            
            // 创建一个Blob对象
            const blob = new Blob([content], { type: 'application/msword' });
            
            // 创建一个下载链接
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = '水泵系统能源诊断规则完整版.doc';
            
            // 模拟点击下载
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // 显示下载成功消息
            alert('文档下载开始！文件名为: 水泵系统能源诊断规则完整版.doc');
        }
    </script>
</body>
</html>